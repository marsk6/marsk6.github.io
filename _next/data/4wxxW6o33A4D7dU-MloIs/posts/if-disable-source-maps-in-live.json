{"pageProps":{"post":{"__typename":"Post","slug":"if-disable-source-maps-in-live","title":"前端优化之是否关闭 sourceMap","tags":[{"__typename":"Tag","name":"性能优化"}],"category":null,"ctime":1651580040000,"date":"05-03","content":"\n## 构建配置是否开启 sourceMap？\n\n看到一些前端性能优化的文章，都建议生产环境关闭 sourceMap，因为 sourceMap 会增大包体积，增加构建时间，不安全泄漏源码，这些都没问题。\n但是关掉 sourceMap，线上出现问题就很难定位了，所以我的建议是**构建配置开启 sourceMap**，部署时过滤掉或上传到内网存储，**不要部署到生产环境**。\n\n## 浏览器如何加载 sourceMap？\n\n以 Chrome 为例，打开 DevTools，开启 source maps\n\n![enable source map](https://cdn.jsdelivr.net/gh/marsk6/image-center@master/if-disable-source-map-1.png)\n\n只要打开 DevTools，浏览器就会自动下载 source maps，否则不会。\n下载 source maps 时的 url 前缀默认和 js 静态资源的前缀一样。\n\n![load source maps](https://cdn.jsdelivr.net/gh/marsk6/image-center@master/if-disable-source-map-2.png)\n\n浏览器自动解析 source maps 后，在 Source -> Page 就会有 webpack 目录。\n\n![Source -> Page](https://cdn.jsdelivr.net/gh/marsk6/image-center@master/if-disable-source-map-3.png)\n\n## 只有 sourceMap，没有 sentry 之类工具时，如何定位线上问题？\n\n一种方法。如果 source maps url 和 js 静态资源的 CDN 域名相同，则可通过代理工具把 source maps 的请求转发到内网服务器，甚至转发到本地\n\n![以 whistle 为例](https://cdn.jsdelivr.net/gh/marsk6/image-center@master/if-disable-source-map-4.png)\n\n## 关联\n\nSourceMapDevToolPlugin：更精细的配置生成的 source maps，例如加载 source maps 的 url\n\n> 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！\n","prevArticle":null,"nextArticle":null,"readingTime":"1","brief":"建议前端构建开启 source maps，定位线上问题的技巧","toc":"- [构建配置是否开启 sourceMap？](#%E6%9E%84%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%98%AF%E5%90%A6%E5%BC%80%E5%90%AF-sourcemap)\n- [浏览器如何加载 sourceMap？](#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%A6%82%E4%BD%95%E5%8A%A0%E8%BD%BD-sourcemap)\n- [只有 sourceMap，没有 sentry 之类工具时，如何定位线上问题？](#%E5%8F%AA%E6%9C%89-sourcemap%E6%B2%A1%E6%9C%89-sentry-%E4%B9%8B%E7%B1%BB%E5%B7%A5%E5%85%B7%E6%97%B6%E5%A6%82%E4%BD%95%E5%AE%9A%E4%BD%8D%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98)\n- [关联](#%E5%85%B3%E8%81%94)"},"relatedTags":[{"__typename":"Tag","name":"性能优化","posts":[{"__typename":"Post","slug":"zh-cn-js-engine-shape-inline-cache"},{"__typename":"Post","slug":"if-disable-source-maps-in-live"}]}]},"__N_SSG":true}