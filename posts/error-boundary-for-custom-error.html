<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link href="/favicon/favicon.ico" rel="icon" sizes="16x16" type="image/png"/><title>ErrorBoundary å¤„ç†è‡ªå®šä¹‰é”™è¯¯ | Marsk In Github</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/70cd17ddadb823f6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/70cd17ddadb823f6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2cf4fae4efea9f72.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-154e49d784c7a281.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ab6f79d107f33341.js" defer=""></script><script src="/_next/static/chunks/621-56a342c7c4e8e893.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-95e4ca493d097a5a.js" defer=""></script><script src="/_next/static/UCwSqtk09_Nc--u7l_P6H/_buildManifest.js" defer=""></script><script src="/_next/static/UCwSqtk09_Nc--u7l_P6H/_ssgManifest.js" defer=""></script></head><body class="bg-gray-100"><div id="__next"><section class="flex flex-col max-w-full bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-50"><header class="css-1cuunsk flex shadow items-center bg-white dark:bg-slate-800"><h1 class="ml-auto my-auto dark:text-slate-200 mr-4 font-medium text-xl text-gray-800 cursor-pointer">Marsk&#x27;s Blog</h1><nav class="container mr-auto max-w-screen-lg  flex items-center gap-2"><div class="py-2 px-4 rounded-md font-semibold text-slate-700 dark:text-slate-200 cursor-pointer css-0 e16hwgoc0">Lab</div></nav><div class="mr-4 cursor-pointer"><span>ğŸŒ</span></div></header><style data-emotion="css kk9mc1">.css-kk9mc1{-webkit-flex:1;-ms-flex:1;flex:1;min-height:calc(100.1vh - var(--header-height));}</style><main class="container mx-auto max-w-3xl p-4 css-kk9mc1 e124l1kd0"><section><article class="p-2"><header class="mb-4"><p class="text-center font-medium text-4xl">ErrorBoundary å¤„ç†è‡ªå®šä¹‰é”™è¯¯</p><div class="mt-2 flex justify-center text-xs items-center gap-4"><div class="flex gap-0.5 items-center"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-calendar"><path d="M4 5m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path><path d="M16 3l0 4"></path><path d="M8 3l0 4"></path><path d="M4 11l16 0"></path><path d="M11 15l1 0"></path><path d="M12 15l0 3"></path></svg>Dec 09<!-- -->, <!-- -->2021</div><div class="flex gap-0.5 items-center"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-clock"><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M12 7l0 5l3 3"></path></svg>2 min read</div></div></header><section class="markdown-body max-w-none dark:bg-slate-900"><h2>èƒŒæ™¯</h2>
<p><a href="https://zh-hans.reactjs.org/docs/error-boundaries.html" target="_blank" rel="nofollow">é”™è¯¯è¾¹ç•Œ</a>æ˜¯ä¸€ç§ React ç»„ä»¶ï¼Œè¿™ç§ç»„ä»¶å¯ä»¥æ•è·å‘ç”Ÿåœ¨å…¶å­ç»„ä»¶æ ‘ä»»ä½•ä½ç½®çš„ JavaScript é”™è¯¯ï¼Œå¹¶æ‰“å°è¿™äº›é”™è¯¯ï¼ŒåŒæ—¶å±•ç¤ºé™çº§ UIã€‚</p>
<p>é”™è¯¯è¾¹ç•Œåœ¨==æ¸²æŸ“æœŸé—´ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œæ•´ä¸ªç»„ä»¶æ ‘çš„æ„é€ å‡½æ•°==ä¸­æ•è·é”™è¯¯ã€‚</p>
<h2>é—®é¢˜</h2>
<p><code>react</code> å¼ºè°ƒäº†åªæœ‰ä¸Šé¢ 3 ç§å®ç°ä¸‹æ‰ä¼šæ•è·é”™è¯¯ã€‚</p>
<p>æ— æ³•è‡ªåŠ¨æ•è·ä¸‹é¢ 4 ç§å®ç°</p>
<ul>
<li>äº‹ä»¶å¤„ç†</li>
<li>å¼‚æ­¥ä»£ç ï¼ˆä¾‹å¦‚ <code>setTimeout</code> ã€<code>Promise</code>å›è°ƒå‡½æ•°ï¼‰</li>
<li>æœåŠ¡ç«¯æ¸²æŸ“</li>
<li>å®ƒè‡ªèº«æŠ›å‡ºæ¥çš„é”™è¯¯ï¼ˆå¹¶éå®ƒçš„å­ç»„ä»¶ï¼‰</li>
</ul>
<p>é€šå¸¸å¸Œæœ›ä¸šåŠ¡ä»£ç èƒ½å¤Ÿå¤ç”¨ <code>ErrorBoundary</code> çš„é”™è¯¯å¤„ç†é€»è¾‘ã€‚</p>
<h2>å®ç°</h2>
<p>å¦‚æœè¦ <code>ErrorBoundary</code> èƒ½å¤„ç†ä¸šåŠ¡ä»£ç çš„è‡ªå®šä¹‰é”™è¯¯ï¼Œåªè¦åœ¨æ¸²æŸ“æœŸé—´æŠ›å‡ºé”™è¯¯å³å¯ã€‚</p>
<h3>class component</h3>
<pre><code class="language-javascript">try {
  const res = await fetchMayError()
} catch (err) {
  this.setState(() =&gt; {
    throw err
  })
}
</code></pre>
<h3>hooks</h3>
<pre><code class="language-typescript">function useErrorHandler() {
  const [error, setError] = React.useState(null)
  if (error != null) throw error
  return setError
}

function Foo() {
  const handleError = useErrorHandler()
  fetchMayError().catch(handleError)
  return &lt;div&gt;&lt;/div&gt;
}
</code></pre>
<h2>Inspired</h2>
<ol>
<li><a href="https://github.com/bvaughn/react-error-boundary" target="_blank" rel="nofollow">https://github.com/bvaughn/react-error-boundary</a></li>
</ol>
<blockquote>
<p>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
</blockquote></section></article></section></main><div class="text-center text-xs text-gray-400 mb-4">Â© 2022 Marsk. Powered by Next.js. Hosted on GitHub.</div></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"error-boundary-for-custom-error","title":"ErrorBoundary å¤„ç†è‡ªå®šä¹‰é”™è¯¯","tags":[{"name":"Blog"},{"name":"react"}],"category":null,"ctime":1639057680000,"date":"Dec 09","content":"\n\n## èƒŒæ™¯\n\n[é”™è¯¯è¾¹ç•Œ](https://zh-hans.reactjs.org/docs/error-boundaries.html)æ˜¯ä¸€ç§ React ç»„ä»¶ï¼Œè¿™ç§ç»„ä»¶å¯ä»¥æ•è·å‘ç”Ÿåœ¨å…¶å­ç»„ä»¶æ ‘ä»»ä½•ä½ç½®çš„ JavaScript é”™è¯¯ï¼Œå¹¶æ‰“å°è¿™äº›é”™è¯¯ï¼ŒåŒæ—¶å±•ç¤ºé™çº§ UIã€‚\n\né”™è¯¯è¾¹ç•Œåœ¨==æ¸²æŸ“æœŸé—´ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œæ•´ä¸ªç»„ä»¶æ ‘çš„æ„é€ å‡½æ•°==ä¸­æ•è·é”™è¯¯ã€‚\n\n## é—®é¢˜\n\n`react` å¼ºè°ƒäº†åªæœ‰ä¸Šé¢ 3 ç§å®ç°ä¸‹æ‰ä¼šæ•è·é”™è¯¯ã€‚\n\næ— æ³•è‡ªåŠ¨æ•è·ä¸‹é¢ 4 ç§å®ç°\n\n- äº‹ä»¶å¤„ç†\n- å¼‚æ­¥ä»£ç ï¼ˆä¾‹å¦‚ `setTimeout` ã€`Promise`å›è°ƒå‡½æ•°ï¼‰\n- æœåŠ¡ç«¯æ¸²æŸ“\n- å®ƒè‡ªèº«æŠ›å‡ºæ¥çš„é”™è¯¯ï¼ˆå¹¶éå®ƒçš„å­ç»„ä»¶ï¼‰\n\né€šå¸¸å¸Œæœ›ä¸šåŠ¡ä»£ç èƒ½å¤Ÿå¤ç”¨ `ErrorBoundary` çš„é”™è¯¯å¤„ç†é€»è¾‘ã€‚\n\n## å®ç°\n\nå¦‚æœè¦ `ErrorBoundary` èƒ½å¤„ç†ä¸šåŠ¡ä»£ç çš„è‡ªå®šä¹‰é”™è¯¯ï¼Œåªè¦åœ¨æ¸²æŸ“æœŸé—´æŠ›å‡ºé”™è¯¯å³å¯ã€‚\n\n### class component\n\n```javascript\ntry {\n  const res = await fetchMayError()\n} catch (err) {\n  this.setState(() =\u003e {\n    throw err\n  })\n}\n```\n\n### hooks\n\n```typescript\nfunction useErrorHandler() {\n  const [error, setError] = React.useState(null)\n  if (error != null) throw error\n  return setError\n}\n\nfunction Foo() {\n  const handleError = useErrorHandler()\n  fetchMayError().catch(handleError)\n  return \u003cdiv\u003e\u003c/div\u003e\n}\n```\n\n## Inspired\n\n1. https://github.com/bvaughn/react-error-boundary\n\n\u003e æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼\n","prev":{},"next":{},"readingTime":"2 min read","toc":"- [èƒŒæ™¯](#%E8%83%8C%E6%99%AF)\n- [é—®é¢˜](#%E9%97%AE%E9%A2%98)\n- [å®ç°](#%E5%AE%9E%E7%8E%B0)\n  * [class component](#class-component)\n  * [hooks](#hooks)\n- [Inspired](#inspired)"},"relatedTags":[{"name":"Blog","posts":[{"slug":"error-boundary-for-custom-error"},{"slug":"git-includeif"},{"slug":"whistle-proxy-in-local-dev"},{"slug":"expo-intro"}]},{"name":"react","posts":[{"slug":"error-boundary-for-custom-error"}]}]},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"error-boundary-for-custom-error"},"buildId":"UCwSqtk09_Nc--u7l_P6H","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>